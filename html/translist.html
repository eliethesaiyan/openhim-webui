<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>HIM - Error Management Console</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">

<!-- Le styles -->
<link href="../css/bootstrap.css" rel="stylesheet">
<script src="../js/jquery.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<style>
body {
	padding-top: 60px;
	/* 60px to make the container go all the way to the bottom of the topbar */
}
</style>

<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

<!-- Le fav and touch icons -->
<link rel="shortcut icon" href="ico/favicon.ico">
<link rel="apple-touch-icon-precomposed" sizes="114x114"
	href="ico/apple-touch-icon-114-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72"
	href="ico/apple-touch-icon-72-precomposed.png">
<link rel="apple-touch-icon-precomposed"
	href="ico/apple-touch-icon-57-precomposed.png">
</head>

<body>

	<div class="navbar navbar-fixed-top">
		<div class="navbar-inner">
			<div class="container">
				<a class="btn btn-navbar" data-toggle="collapse"
					data-target=".nav-collapse"> <span class="icon-bar"></span> <span
					class="icon-bar"></span> <span class="icon-bar"></span>
				</a> <a class="brand" href="#">HIM - Error Management Console</a>
				<ul class="nav">
					<li class="active"><a href="../translist">Transaction Log</a></li>
					<li><a href="../monitor">Monitor</a></li>
				</ul>
				<ul class="nav pull-right">
				  <li class="dropdown">
				    <a href="#"
				          class="dropdown-toggle"
				          data-toggle="dropdown">
				          <i class="icon-user icon-white"></i>
				          ${username}
				          <b class="caret"></b>
				    </a>
				    <ul class="dropdown-menu">
				      <li><a href="../auth/logout">Logout</a></li>
				    </ul>
				  </li>
				</ul>
			</div>
		</div>
	</div>

	<div class="container">

		<h1>Transaction log</h1>

		<br /> <br />

		<form name="filter_form" class="well form-inline">
			<label class="checkbox">
				<input type="checkbox" /> Show only flagged
			</label>
			<label class="checkbox">
				<input type="checkbox" /> Show only un-reviewed
			</label> 
			<label> Status: 
				<select name="status" onchange="document.filter_form.submit();">
					<option>All</option>
					<option
						% if status == '1':
							selected="selected"
						% endif
						value="1">Show Processing</option>
					<option
						% if status == '2':
							selected="selected"
						% endif					
						value="2">Show Completed</option>
					<option
						% if status == '3':
							selected="selected"
						% endif					
						value="3">Show Error'd</option>
				</select>
			</label>
			<label> Endpoint: 
				<select name="endpoint" onchange="document.filter_form.submit();">
					<option>All</option>
					<option
						% if endpoint == 'savePatientEncounter':
							selected="selected"
						% endif
						value="savePatientEncounter">Save Patient Encounter</option>
					<option
						% if endpoint == 'queryForPreviousPatientEncounters':
							selected="selected"
						% endif
						value="queryForPreviousPatientEncounters">Query for previous patient encounters</option>
					<option
						% if endpoint == 'getEncounter':
							selected="selected"
						% endif
						value="getEncounter">Get encounter</option>
					<option
						% if endpoint == 'registerNewClient':
							selected="selected"
						% endif
						value="registerNewClient">Register new client</option>
					<option
						% if endpoint == 'queryForClient':
							selected="selected"
						% endif
						value="queryForClient">Query for clients</option>
					<option
						% if endpoint == 'getClient':
							selected="selected"
						% endif
						value="getClient">Get client</option>
					<option
						% if endpoint == 'updateClientRecord':
							selected="selected"
						% endif
						value="updateClientRecord">Update client record</option>
					<option
						% if endpoint == 'queryForHCFacilities':
							selected="selected"
						% endif
						value="queryForHCFacilities">Query for HC Facilities</option>
					<option
						% if endpoint == 'getHCFacility':
							selected="selected"
						% endif
						value="getHCFacility">Get HC Facility</option>
					<option
						% if endpoint == 'postAlert':
							selected="selected"
						% endif
						value="postAlert">Post Alert</option>
				</select>
			</label> <a class="btn" href="."><i class="icon-refresh"></i></a>
		</form>
		<table class="table table-bordered">
			<thead>
				<tr>
					<th>HTTP Method</th>
					<th>Path</th>
					<th>Request Params</th>
					<th>Status</th>
					<th>Recieved Timestamp</th>
					<th>Reviewed</th>
					<th>Flagged</th>
				</tr>
			</thead>
			<tbody>
				% for row in rows:
					<tr onclick="location.href='../transview?id=${row[0]}';">
						<td><a href="#">${row[5]}</a></td>
						<td><a href="#">${row[2]}</a></td>
						<td>${row[3]}</td>
						<td>
							% if row[13] == 1:
								Processing
							% elif row[13] == 2:
								Completed
							% else:
								Error
							% endif
						</td>
						<td>${row[9]}</td>
						<td></td>
						<td></td>
					</tr>
				% endfor
			</tbody>
		</table>

		<ul class="pager">
			% if page > 1:
			<li class="previous"><a href="?page=${int(page) - 1}">&larr; Newer</a></li>
			% endif
			% if page is not int(max_page):
			<li class="next"><a href="?page=${int(page) + 1}">Older &rarr;</a></li>
			% endif
		</ul>

	</div>
	<!-- /container -->

</body>
</html>
